(()=>{"use strict";var e={559:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.badge=r.colorIndex=r.color=r.logEntries=r.logSuccess=r.logError=r.logWarn=r.logProgress=r.logInfo=r.log=void 0;const o=t(22);r.log=console.log.bind(console),r.logInfo=(...e)=>{console.info(o.bold.blueBright("ℹ"),...e)},r.logProgress=(...e)=>{console.info((0,o.gray)("➤"),...e)},r.logWarn=(...e)=>{console.info((0,o.red)("△"),...e)},r.logError=(...e)=>{e.forEach((e=>{console.error(o.bold.underline.redBright("✘"),e)}))},r.logSuccess=(...e)=>{console.info(o.bold.greenBright("✔"),...e)},r.logEntries=e=>{(0,r.logInfo)(o.bold.cyanBright("Building entries:")),e.forEach((({name:e,target:t,entry:l})=>{(0,r.log)(`   ${e} (${(0,o.italic)(t)}):`),Object.keys(l).forEach((e=>{(0,r.log)(`     ${e}`)}))}))};const l={green:o.green,yellow:o.yellow,blue:o.blue,magenta:o.magenta,cyan:o.cyan,greenBright:o.greenBright,yellowBright:o.yellowBright,blueBright:o.blueBright,magentaBright:o.magentaBright,cyanBright:o.cyanBright},n=Object.keys(l),i={green:o.bgGreen,yellow:o.bgYellow,blue:o.bgBlue,magenta:o.bgMagenta,cyan:o.bgCyan,greenBright:o.bgGreenBright,yellowBright:o.bgYellowBright,blueBright:o.bgBlueBright,magentaBright:o.bgMagentaBright,cyanBright:o.bgCyanBright,red:o.bgRed,redBright:o.bgRedBright};r.color=(e,r="blue")=>r?l[r](e):e,r.colorIndex=(e,t=0)=>{const o=n[t%n.length];return(0,r.color)(e,o)},r.badge=(e,r="blueBright")=>r?i[r](` ${(0,o.bold)(e)} `):e},584:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.removeExt=r.merge=r.resolve=r.resolver=r.getName=r.getDir=r.normalize=r.PathResolver=void 0;const o=t(17);class l{constructor(e){this.rootPath=(0,r.normalize)((0,o.resolve)(e))}relative(e){return(0,r.normalize)((0,o.relative)(this.rootPath,(0,r.normalize)(e)))}relativeList(e){return e.map((e=>this.relative(e)))}includes(e){return 0===(0,r.normalize)(e).indexOf(this.rootPath)}resolve(...e){return(0,r.normalize)((0,o.resolve)(this.rootPath,...e.filter(Boolean).map((e=>e.replace(/^\/+/,"")))))}resolveList(e){return e.map((e=>this.resolve(e)))}dir(){return(0,r.resolver)((0,r.getDir)(this.rootPath))}res(...e){return(0,r.resolver)(this.resolve(...e))}}r.PathResolver=l,r.normalize=e=>(null==e?void 0:e.replace(/\\/g,"/"))||"",r.getDir=e=>(0,r.normalize)(e).replace(/\/[^/]+\/?$/,""),r.getName=e=>(0,o.basename)((0,r.normalize)(e)),r.resolver=e=>new l(e),r.resolve=e=>(0,r.normalize)((0,o.resolve)(e)),r.merge=(...e)=>(0,r.normalize)((0,o.join)(...e)),r.removeExt=e=>null==e?void 0:e.replace(/\.([^/]+)$/,"")},163:function(e,r,t){var o=this&&this.__awaiter||function(e,r,t,o){return new(t||(t=Promise))((function(l,n){function i(e){try{a(o.next(e))}catch(e){n(e)}}function s(e){try{a(o.throw(e))}catch(e){n(e)}}function a(e){var r;e.done?l(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,s)}a((o=o.apply(e,r||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0});const l=t(470),n=t(906),i=t(559),s=t(584),a=/([^/]+\/[^/]+)/;let g=0;r.default=class{constructor(e){this.path=(0,s.resolver)(e)}apply(e){let r=[];e.hooks.beforeCompile.tapPromise("[dts] start collecting built modules",(()=>o(this,void 0,void 0,(function*(){r=[]})))),e.hooks.compilation.tap("[dts] setup compilation",(e=>{e.hooks.succeedModule.tap("[dts] collect built module",(e=>{if("NormalModule"!==e.constructor.name)return;const t=this.path.relative(e.context||""),o=!t.includes("node_modules")&&!t.includes(".yarn")&&t.match(a);o&&!r.includes(o[0])&&r.push(o[0])}))})),e.hooks.afterCompile.tap("[dts] generate definitions",(()=>{Promise.all(r.map((e=>o(this,void 0,void 0,(function*(){const r=g+=1;try{const t=yield(0,l.readJSON)(this.path.resolve(e,"package.json")),o=t.types,a=t.name,g=this.path.resolve(e),c=this.path.resolve(e,o),h=t.main||"index",u=t.files||"";if(!o)return;let d=this.path.resolve(e,"tsconfig.json");if((yield(0,l.pathExists)(d))||(d=this.path.resolve("tsconfig.json")),!(yield(0,l.pathExists)(d)))return void(0,i.logWarn)(this.log(r,a,"generation ignored, required tsconfig"));const p=new n.Dts,v=u.map((r=>(0,s.resolver)(g).relative(this.path.resolve(e,r))));p.on("log",(e=>{(0,i.logProgress)(this.log(r,e))})),(0,i.logInfo)(this.log(r,a,"generation started")),yield p.generate({projectPath:d,name:a,inputDir:g,outputPath:c,main:(0,s.removeExt)(h.replace(/^(\.\/?)+/,"")),filePatterns:v}),(0,i.logSuccess)(this.log(r,a,"declaration at",o))}catch(e){(0,i.logError)(this.log(r,e.message))}})))))}))}log(e,...r){let t=r.join(" ");return 0!==t.indexOf("[dts")&&(t=`[dts] ${t}`),t.replace(/^\[(dtsw?)\]/,((r,t)=>(0,i.colorIndex)(`[${t} ${e}]`,e)))}}},22:e=>{e.exports=require("chalk")},470:e=>{e.exports=require("fs-extra")},906:e=>{e.exports=require("@teku/builder/src/lib/dts/index.js")},17:e=>{e.exports=require("path")}},r={},t=function t(o){var l=r[o];if(void 0!==l)return l.exports;var n=r[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}(163);module.exports=t})();