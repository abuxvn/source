(()=>{"use strict";var e={559:function(e,o,t){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.logEntries=o.logSuccess=o.logError=o.logWarn=o.logProgress=o.logInfo=o.log=void 0;const s=r(t(22)),{bold:i,red:l,gray:n}=s.default;o.log=console.log.bind(console),o.logInfo=(...e)=>{console.info(i.blueBright("ℹ"),...e)},o.logProgress=(...e)=>{console.info(n("➤"),...e)},o.logWarn=(...e)=>{console.info(l("△"),...e)},o.logError=(...e)=>{e.forEach((e=>{console.error(i.underline.redBright("✘"),e)}))},o.logSuccess=(...e)=>{console.info(i.greenBright("✔"),...e)},o.logEntries=e=>{(0,o.logInfo)(i.cyanBright("Building entries:")),e.forEach((({name:e,target:t,entry:r})=>{(0,o.log)(`   ${e} (${s.default.italic(t)}):`),Object.keys(r).forEach((e=>{(0,o.log)(`     ${e}`)}))}))}},584:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.removeExt=o.merge=o.resolve=o.resolver=o.getName=o.getDir=o.normalize=o.PathResolver=void 0;const r=t(17);class s{constructor(e){this.rootPath=(0,o.normalize)((0,r.resolve)(e))}relative(e){return(0,o.normalize)((0,r.relative)(this.rootPath,(0,o.normalize)(e)))}relativeList(e){return e.map((e=>this.relative(e)))}includes(e){return 0===(0,o.normalize)(e).indexOf(this.rootPath)}resolve(...e){return(0,o.normalize)((0,r.resolve)(this.rootPath,...e.filter(Boolean).map((e=>e.replace(/^\/+/,"")))))}resolveList(e){return e.map((e=>this.resolve(e)))}dir(){return(0,o.resolver)((0,o.getDir)(this.rootPath))}res(...e){return(0,o.resolver)(this.resolve(...e))}}o.PathResolver=s,o.normalize=e=>(null==e?void 0:e.replace(/\\/g,"/"))||"",o.getDir=e=>(0,o.normalize)(e).replace(/\/[^/]+\/?$/,""),o.getName=e=>(0,r.basename)((0,o.normalize)(e)),o.resolver=e=>new s(e),o.resolve=e=>(0,o.normalize)((0,r.resolve)(e)),o.merge=(...e)=>(0,o.normalize)((0,r.join)(...e)),o.removeExt=e=>null==e?void 0:e.replace(/\.([^/]+)$/,"")},163:function(e,o,t){var r=this&&this.__awaiter||function(e,o,t,r){return new(t||(t=Promise))((function(s,i){function l(e){try{a(r.next(e))}catch(e){i(e)}}function n(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(l,n)}a((r=r.apply(e,o||[])).next())}))};Object.defineProperty(o,"__esModule",{value:!0});const s=t(470),i=t(644),l=t(559),n=t(584),a=/([^/]+\/[^/]+)/;let c=0;o.default=class{constructor(e){this.rootPath=e,this.path=(0,n.resolver)(e)}apply(e){let o=[];e.hooks.beforeCompile.tapPromise("[dts] start collecting built modules",(()=>r(this,void 0,void 0,(function*(){o=[]})))),e.hooks.compilation.tap("[dts] setup compilation",(e=>{e.hooks.succeedModule.tap("[dts] collect built module",(e=>{if("NormalModule"!==e.constructor.name)return;const t=this.path.relative(e.context||""),r=!t.includes("node_modules")&&!t.includes(".yarn")&&t.match(a);r&&!o.includes(r[0])&&o.push(r[0])}))})),e.hooks.afterCompile.tap("[dts] generate definitions",(()=>{Promise.all(o.map((e=>r(this,void 0,void 0,(function*(){const o=c+=1;try{const t=yield(0,s.readJSON)(this.path.resolve(e,"package.json")),r=t.types,a=t.name,c=this.path.resolve(e),u=this.path.resolve(e,r),d=t.main||"index",h=t.files||"";if(!r)return;let p=this.path.resolve(e,"tsconfig.json");if((yield(0,s.pathExists)(p))||(p=this.path.resolve("tsconfig.json")),!(yield(0,s.pathExists)(p)))return void(0,l.logWarn)(`[dts ${o}]`,a," generation ignored, required tsconfig");const g=new i.Dts,v=h.map((o=>(0,n.resolver)(c).relative(this.path.resolve(e,o))));g.on("log",(e=>{(0,l.logProgress)(e.replace(/^\[(dtsw?)\]/,`[$1 ${o}]`))})),(0,l.logInfo)(`[dts ${o}]`,a,"generation started"),yield g.generate({projectPath:p,name:a,inputDir:c,outputPath:u,main:(0,n.removeExt)(d.replace(/^(\.\/?)+/,"")),filePatterns:v}),(0,l.logSuccess)(`[dts ${o}]`,a,"declaration at",r)}catch(e){(0,l.logError)(`[dts ${o}] ${e.message}`)}})))))}))}}},22:e=>{e.exports=require("chalk")},470:e=>{e.exports=require("fs-extra")},644:e=>{e.exports=require("../../lib/dts/index.js")},17:e=>{e.exports=require("path")}},o={},t=function t(r){var s=o[r];if(void 0!==s)return s.exports;var i=o[r]={exports:{}};return e[r].call(i.exports,i,i.exports,t),i.exports}(163);module.exports=t})();